#include <Windows.h>

HBITMAP hBrendon1;

void loadImages();
void ImageWindows();

HWND hMainWindow, hImageWindow;
LRESULT CALLBACK wc_callback(HWND, UINT, WPARAM, LPARAM);
LRESULT result;

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrev, LPSTR args, int ncmdshow) {

	//MAIN WINDOW CLASS
	WNDCLASSW wc = {};
	wc.hbrBackground = (HBRUSH)COLOR_DESKTOP;
	wc.hInstance = hInstance;
	wc.lpszClassName = L"mainClass";
	wc.lpfnWndProc = wc_callback;

	RegisterClassW(&wc);

	hMainWindow = CreateWindowW(wc.lpszClassName, L"Main Window", WS_VISIBLE | WS_OVERLAPPEDWINDOW, 100, 100, 600, 500, NULL, NULL, NULL, NULL);
	//MAIN WINDOW CLASS

	MSG msg;
	while (GetMessage(&msg, NULL, NULL, NULL)) {
		TranslateMessage(&msg);
		DispatchMessageW(&msg);
	}
}

LRESULT CALLBACK wc_callback(HWND hImageWindow, UINT msg, WPARAM wp, LPARAM lp) {
	switch (msg) {
		case WM_CREATE: {
			loadImages();
			ImageWindows();
			return 0;
		}
		case WM_DESTROY: {
			PostQuitMessage(0);
			break;
		}
		default: {
			return result = DefWindowProcW(hImageWindow, msg, wp, lp);
		}
	}
	return result;
}

void loadImages() {
	LPCWSTR fileToLoad = L"F://brendon1.bmp";
	hBrendon1 = (HBITMAP)LoadImageW(NULL, fileToLoad, IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE);
	if (hBrendon1 == NULL) {
		DWORD error = GetLastError();
		LPTSTR output = NULL;
		FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_IGNORE_INSERTS, NULL, error, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), (LPTSTR)&output, 0, NULL);
		MessageBox(NULL, output, L"Error. Reason:", MB_OK);
	}
	else {
		MessageBox(NULL, L"Image was found and assigned successfully!", L"Success!", MB_OK);
	}
}

void ImageWindows() {
	hImageWindow = CreateWindowW(L"Static", NULL, WS_VISIBLE | WS_CHILD | SS_BITMAP, 30, 30, 517, 450, NULL, NULL, NULL, NULL);
	SendMessageW(hImageWindow, STM_SETIMAGE, IMAGE_BITMAP, (LPARAM)hBrendon1);
}